<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>SocketIO æµ‹è¯•</title>
    <script src="https://cdn.socket.io/4.5.4/socket.io.min.js"></script>
    <style>
        body {
            font-family: 'Segoe UI', sans-serif;
            background: #1e293b;
            color: #e2e8f0;
            padding: 20px;
        }
        button {
            background: #3b82f6;
            color: white;
            border: none;
            padding: 12px 24px;
            margin: 10px 5px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
        }
        button:hover {
            background: #2563eb;
        }
        #status {
            padding: 20px;
            background: #0f172a;
            border-radius: 8px;
            margin: 20px 0;
        }
        .success { color: #10b981; }
        .error { color: #ef4444; }
    </style>
</head>
<body>
    <h1>ğŸ§ª Real-Time Terminal å›¾ç‰‡æµ‹è¯•</h1>
    
    <div id="status">
        <h3>è¿æ¥çŠ¶æ€: <span id="connectionStatus" class="error">æœªè¿æ¥</span></h3>
    </div>
    
    <div>
        <button onclick="sendTestLogs()">ğŸ“¤ å‘é€æµ‹è¯•æ—¥å¿—ï¼ˆå«å›¾ç‰‡ï¼‰</button>
        <button onclick="sendScanningLog()">ğŸ” å‘é€æ‰«ææ—¥å¿—</button>
        <button onclick="sendWarningLog()">âš ï¸ å‘é€è­¦å‘Šæ—¥å¿—</button>
        <button onclick="window.open('http://localhost:7897', '_blank')">ğŸš€ æ‰“å¼€ä¸»é¡µé¢</button>
    </div>
    
    <div style="margin-top: 30px; padding: 20px; background: #0f172a; border-radius: 8px;">
        <h3>ğŸ“‹ æµ‹è¯•æ­¥éª¤ï¼š</h3>
        <ol>
            <li>æ‰“å¼€ä¸»é¡µé¢ (ç‚¹å‡»ä¸Šé¢çš„"æ‰“å¼€ä¸»é¡µé¢"æŒ‰é’®)</li>
            <li>è¿”å›è¿™ä¸ªé¡µé¢</li>
            <li>ç‚¹å‡»"å‘é€æµ‹è¯•æ—¥å¿—"æŒ‰é’®</li>
            <li>åœ¨ä¸»é¡µé¢è§‚å¯ŸReal-Time Terminalä¸­çš„æ—¥å¿—å’Œå›¾ç‰‡é¢„è§ˆ</li>
        </ol>
    </div>

    <script>
        // è¿æ¥åˆ°ä¸»æœåŠ¡å™¨
        const socket = io('http://localhost:7897');
        
        socket.on('connect', () => {
            document.getElementById('connectionStatus').textContent = 'âœ… å·²è¿æ¥';
            document.getElementById('connectionStatus').className = 'success';
            console.log('âœ… Connected to Cassandra server');
        });
        
        socket.on('disconnect', () => {
            document.getElementById('connectionStatus').textContent = 'âŒ æ–­å¼€';
            document.getElementById('connectionStatus').className = 'error';
            console.log('âŒ Disconnected');
        });
        
        function sendTestLogs() {
            console.log('ğŸ“¤ Sending test logs with images...');
            
            // æµ‹è¯•å›¾ç‰‡è·¯å¾„
            const testImages = [
                'western_blot_1.png',
                'gel_electrophoresis.png',
                'microscopy_image.png',
                'figure_analysis.png'
            ];
            
            // å¼€å§‹åˆ†æ
            socket.emit('log', {
                level: 'info',
                message: 'ğŸš€ [TEST] Starting forensic analysis simulation...'
            });
            
            // é€ä¸ªæ‰«æå›¾ç‰‡
            testImages.forEach((imgName, idx) => {
                setTimeout(() => {
                    // æ‰«ææ—¥å¿—ï¼ˆå¸¦å›¾ç‰‡ï¼‰
                    socket.emit('log', {
                        level: 'scanning',
                        message: `ğŸ” Analyzing figure ${idx + 1}/${testImages.length}: ${imgName}`,
                        image_path: `/static/temp/${imgName}`
                    });
                    
                    // åˆ†æç»“æœ
                    setTimeout(() => {
                        if (idx === 1) {
                            socket.emit('log', {
                                level: 'warning',
                                message: `    âš ï¸  SUSPICIOUS (risk: 0.75) - Potential manipulation`,
                                image_path: `/static/temp/${imgName}`
                            });
                        } else {
                            socket.emit('log', {
                                level: 'success',
                                message: '    âœ… CLEAN (risk: 0.00) - No anomalies detected'
                            });
                        }
                    }, 500);
                    
                }, idx * 1500);
            });
            
            // å®Œæˆ
            setTimeout(() => {
                socket.emit('log', {
                    level: 'success',
                    message: `âœ… [TEST] Forensic audit complete: ${testImages.length} figures analyzed`
                });
            }, testImages.length * 1500 + 500);
            
            alert('âœ… æµ‹è¯•æ—¥å¿—å·²å‘é€ï¼\nè¯·æŸ¥çœ‹ä¸»é¡µé¢çš„Real-Time Terminal');
        }
        
        function sendScanningLog() {
            socket.emit('log', {
                level: 'scanning',
                message: 'ğŸ” Analyzing figure: test_western_blot.png',
                image_path: '/static/temp/test_western_blot.png'
            });
            alert('âœ… æ‰«ææ—¥å¿—å·²å‘é€ï¼');
        }
        
        function sendWarningLog() {
            socket.emit('log', {
                level: 'warning',
                message: 'âš ï¸  SUSPICIOUS - Detected image manipulation',
                image_path: '/static/temp/suspicious_image.png'
            });
            alert('âœ… è­¦å‘Šæ—¥å¿—å·²å‘é€ï¼');
        }
    </script>
</body>
</html>
